# 前端使用手册

本手册面向业务与运营同学，说明控制台页面的功能与交互方式。前端静态资源位于 `frontend/`，后端自动挂载到 `/console`。

控制台默认使用原始 API 路径（无前缀）。

---

## 1. 页面入口

- 登录页面：`/console/login.html`
- 总览仪表盘：`/console/index.html`
- 应用控制台：`/console/app.html?app_id=<app_id>`
- 数据存储：`/console/stores.html`
- 设置：`/console/settings.html`
- 验证中心：`/console/validation.html`
- 摄取作业：`/console/ingestion_jobs.html`

---

## 1.1 身份与租户

- 控制台需先登录 `wallet_id`
- 可在“设置”页面修改钱包 ID，刷新后生效
- 超级管理员可跨租户查看应用与 KB
- 控制台仅面向开发者/管理员，业务用户数据通过筛选查看

---

## 1.2 视觉主题与控件规范

- 视觉变量集中在 `frontend/assets/styles.css`，主要调整 `--accent`、`--bg-0`、`--border`
- 按钮与表单统一高度 `--control-height`，主要动作使用 `.primary`
- JSON / ID 类字段使用 `.text-mono` 以便区分结构化内容

---

## 2. 总览仪表盘

功能：

- 展示应用列表、知识库数量、向量条目数
- 摄取时间线（最近事件）
- 快速跳转 Stores / Settings / 应用控制台

交互说明：

- 顶部 API 状态指示灯基于 `/health`
- “刷新应用”会更新应用与 KB 统计
- “查看摄取”滚动到摄取区域
- “验证中心”进入可视化验证页

---

## 3. 应用控制台

### 3.1 知识库

显示当前应用的 KB 列表与详细配置：

- collection 名
- 文档数量
- 向量数量
- 权限模式（public / restricted）

### 3.2 文档表格

文档管理能力：

- 表头点击排序
- 分页与每页条数切换
- 列偏好持久化（localStorage）
- 复选框 + 批量导出 / 删除
- 详情抽屉：字段详情 + JSON + 编辑表单

### 3.3 记忆写入

表单调用 `/memory/push`：

- 适合直接测试会话历史写入
- 写入后会显示返回信息

### 3.4 摄取时间线

展示当前应用最近摄取事件：

- 支持导出 JSON
- 与 `/ingestion/logs` 数据源一致

---

## 4. 数据存储

功能：

- 展示 `/stores/health` 检查结果
- 显示存储健康状态、诊断信息
- 提供快速进入应用控制台的入口

---

## 5. 设置

功能：

- 设置 API Base（如访问非同源后端）
- 设置钱包 ID（租户身份）
- 连接测试
- 清空缓存的 API Base

---

## 6. 验证中心

功能：

- 选择目标应用，运行接口验证清单
- 一键执行全量测试，实时显示结果
- 用于检查租户隔离、应用状态与存储健康
- 输出详情面板显示接口返回的完整 JSON

---

## 7. 摄取作业

功能：

- 创建摄取作业（MinIO URL 或内联文本）
- 运行作业并查看状态
- 查看作业执行记录
- 绑定数据归属钱包（业务用户）

交互说明：

- 运行结果会同步到作业详情输出面板
- 失败会展示 error_message 和 runs 日志
- “最近文件”支持从 MinIO 前缀快速选择
- `user_upload` 类型 KB 会按“数据归属钱包”隔离文件与向量
- 作业列表支持按业务用户钱包筛选，并展示操作钱包与业务用户钱包

## 7.1 业务用户筛选

- 记忆视图：使用“业务用户 wallet_id + 会话 ID”定位具体用户对话
- 摄取作业：使用“业务用户钱包”查看该用户的摄取与数据归属

## 7.2 记忆展开

- 点击会话列表行会自动展开对应的记忆详情

---

## 8. 常见问题

- 页面显示离线：检查 `/health` 是否返回 OK
- 文档为空：确认选中的 KB 与 `wallet_id` 过滤条件
- 新建文档无向量：确保填写 `text` 或提交向量字段
